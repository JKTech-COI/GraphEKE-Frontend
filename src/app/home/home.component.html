<!-- header.component.html -->

<div class="header">
  <div class="card text-light d-flex p-2 flex-row rounded-0" style="background: #fff; box-shadow: 0px 4px 10px 0px rgba(0, 0, 0, 0.10);">
      <svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 158 45" fill="none">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M38.054 23.5657L47.5776 10.8879H43.5114C43.5114 10.8879 41.513 10.8879 40.1832 13.1456L33.373 21.9121C33.004 22.3878 32.7657 22.9541 32.7273 23.543L32.7504 23.7771C32.8195 24.2906 33.0424 24.7738 33.3576 25.1891L40.1832 33.9782C41.513 36.2359 43.5114 36.2359 43.5114 36.2359H47.5776L38.054 23.5657Z" fill="#4474FC"/>
          <path d="M9.62178 32.0301C7.98456 31.7281 6.38577 32.6568 5.94764 34.235L5.74011 34.9825C7.29278 36.032 9.16828 36.5606 11.3512 36.5606C13.4881 36.5606 15.1945 36.251 16.4551 35.6319C17.7157 35.0127 18.6841 34.1444 19.3529 33.0193C20.0216 31.8942 20.4597 30.5426 20.6673 28.957C20.8748 27.3713 20.9747 25.6044 20.9747 23.6714V10.7369H15.9401V23.6714C15.9401 25.1061 15.8939 26.3519 15.794 27.4166C15.6941 28.4813 15.4866 29.3723 15.1714 30.0896C14.8563 30.8069 14.3951 31.3355 13.7879 31.6828C13.1806 32.0301 12.3659 32.1963 11.3436 32.2038C10.7133 32.1887 10.1368 32.1283 9.62178 32.0301Z" fill="#4474FC"/>     
          <path d="M27.3699 10.6086H25.4944V32.9438C25.4944 34.6578 26.9087 36.0396 28.6458 36.0396H30.5213V13.7044C30.5213 11.9979 29.107 10.6086 27.3699 10.6086Z" fill="#4474FC"/>     
          <path fill-rule="evenodd" clip-rule="evenodd" d="M54.2342 10.6086H53.1274H51.8975C49.1688 10.9031 48.9382 13.274 48.9382 13.274V14.8446H53.1274H54.2342H55.4641C58.1928 14.5501 58.4234 12.1792 58.4234 12.1792V10.6086H54.2342Z" fill="#110930"/>    
          <path d="M81.1522 31.7055V25.0759H88.9002C90.645 25.0759 92.0516 23.6865 92.0516 21.9801V21.0664H81.1522V14.9427H90.6143C92.3591 14.9427 93.7657 13.5534 93.7657 11.8469V10.6086H76.1176V32.9438C76.1176 34.6578 77.5319 36.0396 79.269 36.0396H90.9371C92.6819 36.0396 94.0886 34.6503 94.0886 32.9438V31.7055H81.1522Z" fill="#110930"/>   
          <path d="M95.4644 27.9301C96.087 29.4931 96.9479 30.89 98.0548 32.1208C99.1616 33.3515 100.476 34.3482 102.013 35.1109C103.543 35.8735 105.234 36.2586 107.079 36.2586C108.124 36.2586 109.193 36.1302 110.284 35.8659C111.375 35.6017 112.405 35.2166 113.366 34.7182C114.327 34.2199 115.188 33.6007 115.957 32.8758C116.725 32.1434 117.309 31.3053 117.724 30.3463L115.726 29.2213C114.642 28.6096 113.328 28.8966 112.452 29.78C112.444 29.7876 111.422 30.6861 110.853 30.9957C110.284 31.3053 109.677 31.5318 109.046 31.6753C108.416 31.8187 107.809 31.8942 107.225 31.8942C106.103 31.8942 105.08 31.6526 104.142 31.1769C103.205 30.7012 102.405 30.0669 101.737 29.2817C101.068 28.4964 100.553 27.5827 100.184 26.5407C99.815 25.4987 99.6382 24.4189 99.6382 23.3014C99.6382 22.2972 99.7996 21.2929 100.115 20.2736C100.43 19.2618 100.899 18.3557 101.521 17.5553C102.144 16.7549 102.92 16.1055 103.858 15.5996C104.796 15.1013 105.895 14.8446 107.156 14.8446C107.74 14.8446 108.332 14.9125 108.947 15.0409C109.554 15.1693 110.138 15.3807 110.699 15.6676C111.26 15.9545 111.783 16.3396 112.267 16.8304C112.275 16.838 112.275 16.838 112.282 16.8455C113.159 17.729 114.504 17.963 115.542 17.2608L117.371 16.0225C116.518 14.3764 115.226 13.0399 113.489 12.013C111.752 10.9861 109.692 10.4727 107.309 10.4727C105.295 10.4727 103.489 10.8426 101.913 11.5826C100.33 12.3226 98.9925 13.2891 97.901 14.4821C96.8096 15.6751 95.9717 17.0343 95.4029 18.5444C94.8341 20.0621 94.5497 21.595 94.5497 23.1504C94.5344 24.7738 94.8418 26.367 95.4644 27.9301Z" fill="#110930"/>     
          <path d="M121.798 10.6085H119.923C119.923 10.6085 119.923 13.9686 119.923 18.2499C119.923 21.4817 119.923 25.2344 119.923 28.451V32.9362C119.923 34.6502 121.337 36.032 123.074 36.032H124.95C124.95 36.032 124.95 32.6719 124.95 28.3906V18.1971V13.7119C124.95 11.9979 123.543 10.6085 121.798 10.6085Z" fill="#110930"/>    
          <path d="M139.846 10.6085C138.101 10.6085 136.695 11.9979 136.695 13.7044V20.8852V21.0211H130.054C127.325 21.3156 127.094 23.6865 127.094 23.6865V25.2571H136.695V32.9362C136.695 34.6502 138.109 36.032 139.846 36.032H141.691V10.601H139.846V10.6085Z" fill="#110930"/>     
          <path d="M60.6369 14.9427V36.0396H62.4817C64.2266 36.0396 65.6332 34.6503 65.6332 32.9438V14.9427H70.7601C72.4972 14.9427 73.9115 13.5534 73.9115 11.8469V10.6086C73.9115 10.6086 66.0175 10.6086 60.6293 10.6086L60.6369 14.9427Z" fill="#110930"/>      
          <path d="M33.373 21.9196C33.004 22.3953 32.7657 22.9616 32.7273 23.5506L32.7504 23.7847C32.8195 24.2981 33.0424 24.7814 33.3576 25.1967L35.1255 27.4695L38.054 23.5657L35.1255 19.6695L33.373 21.9196Z" fill="#324FB5"/>      
          <path d="M149.439 10.4651C149.693 10.4651 149.931 10.4953 150.169 10.5633C150.4 10.6312 150.623 10.7143 150.822 10.8351C151.022 10.9484 151.207 11.0918 151.376 11.2579C151.545 11.4241 151.683 11.6053 151.806 11.8016C151.922 11.9979 152.014 12.2169 152.083 12.4434C152.145 12.6699 152.183 12.9115 152.183 13.1607C152.183 13.4023 152.152 13.644 152.083 13.8705C152.014 14.097 151.929 14.316 151.806 14.5123C151.691 14.7086 151.545 14.8899 151.376 15.056C151.207 15.2221 151.022 15.358 150.822 15.4788C150.623 15.5921 150.4 15.6827 150.169 15.7506C149.939 15.8186 149.693 15.8488 149.439 15.8488C149.185 15.8488 148.947 15.8186 148.716 15.7506C148.486 15.6902 148.271 15.5996 148.071 15.4788C147.871 15.358 147.686 15.2221 147.517 15.056C147.348 14.8899 147.21 14.7086 147.087 14.5123C146.972 14.316 146.879 14.1046 146.81 13.8781C146.741 13.6515 146.71 13.4099 146.71 13.1683C146.71 12.9191 146.741 12.685 146.81 12.4509C146.872 12.2244 146.964 12.0055 147.087 11.8091C147.202 11.6128 147.348 11.4316 147.517 11.2655C147.686 11.0994 147.871 10.9634 148.071 10.8426C148.271 10.7294 148.486 10.6388 148.716 10.5708C148.947 10.4953 149.193 10.4651 149.439 10.4651ZM149.439 15.3958C149.646 15.3958 149.846 15.3656 150.038 15.3127C150.231 15.2598 150.407 15.1843 150.577 15.0862C150.746 14.988 150.892 14.8747 151.03 14.7388C151.168 14.6029 151.284 14.4519 151.376 14.2858C151.468 14.1197 151.545 13.9385 151.599 13.7497C151.653 13.5609 151.676 13.3571 151.676 13.1456C151.676 12.9342 151.653 12.7303 151.599 12.5416C151.545 12.3452 151.468 12.164 151.376 11.9979C151.276 11.8318 151.161 11.6732 151.03 11.5373C150.892 11.4014 150.738 11.2806 150.577 11.1824C150.415 11.0843 150.231 11.0088 150.038 10.9559C149.846 10.9031 149.646 10.8728 149.439 10.8728C149.231 10.8728 149.032 10.9031 148.839 10.9559C148.647 11.0088 148.47 11.0843 148.309 11.1824C148.148 11.2806 147.994 11.4014 147.863 11.5373C147.733 11.6732 147.617 11.8243 147.517 11.9979C147.417 12.164 147.348 12.3452 147.294 12.5416C147.241 12.7379 147.218 12.9342 147.218 13.1456C147.218 13.4628 147.271 13.7572 147.387 14.0291C147.502 14.3009 147.656 14.5425 147.855 14.7464C148.055 14.9503 148.294 15.1088 148.563 15.2221C148.839 15.3429 149.131 15.3958 149.439 15.3958ZM149.431 11.5147C149.892 11.5147 150.231 11.5977 150.446 11.7563C150.661 11.9149 150.769 12.1489 150.769 12.4509C150.769 12.6699 150.715 12.8511 150.6 13.0173C150.484 13.1758 150.308 13.2967 150.069 13.3646C150.123 13.4024 150.169 13.4401 150.208 13.4854C150.246 13.5307 150.284 13.5911 150.315 13.6515L150.984 14.769H150.223C150.115 14.769 150.031 14.7313 149.992 14.6482L149.462 13.6893C149.439 13.6591 149.408 13.6289 149.377 13.6138C149.347 13.5987 149.301 13.5836 149.239 13.5836H149.039V14.7615H148.248V11.4996H149.431V11.5147ZM149.354 13.0324C149.485 13.0324 149.585 13.0248 149.67 13.0022C149.746 12.9795 149.816 12.9493 149.862 12.9116C149.908 12.8738 149.939 12.8209 149.954 12.7605C149.969 12.7001 149.977 12.6322 149.977 12.5567C149.977 12.4812 149.969 12.4132 149.954 12.3603C149.939 12.2999 149.908 12.2546 149.869 12.2169C149.831 12.1791 149.769 12.1489 149.7 12.1338C149.631 12.1187 149.539 12.1036 149.424 12.1036H149.032V13.0399H149.354V13.0324Z" fill="#110930"/>      
        </svg>
    <div class="form-group has-search ms-auto me-3">
    </div>
  </div>
</div>

<div class="home-container">
    <div class="left-section"> 
      <button data-bs-toggle="modal" data-bs-target="#getSource">Add Data</button>
      <!-- <button (click)="selection()">Add Data </button> -->
      <div class="Structured" >
        <h6>Structured</h6>
        <p *ngFor="let source of structName" style="margin-bottom: 10px;text-decoration: none;">* {{source}}</p> 
      </div>
      <div class="unStructured" >
        <h6>Unstructured</h6>
        <p *ngFor="let file of UnstructName" style="margin-bottom: 10px;">* {{file.name}}</p>
      </div>
    </div>

    <div class="separator"></div>

    <div class="right-section"> 
      <div class="upper-section">
        <p>Chat Window
          <span class="ml-auto">
            <button class="btn btn-primary" (click)="reset()">Reset</button>
          </span>
        </p>
        <hr class="top_hr" >
        <div class="chatContainer">
          <div class="chatSection">
            <ng-container *ngFor="let message of chatMessages">
              <div class="message" [ngClass]="{'question': message.type === 'question', 'response': message.type === 'response'}">
                {{ message.content }}
              </div>
            </ng-container>
          </div>
          <div *ngIf="loading1" class="loading">
            <mat-spinner diameter="50" color="primary"></mat-spinner>
          </div>
          <div class="input-container">
            <input type="text" placeholder="Type your question..." [(ngModel)]="chatInput" (keyup.enter)="sendRequest()" [disabled]="isInputEnable"/>
            <mat-icon (click)="sendRequest()">send</mat-icon>
          </div>
        </div>
      </div>
      <hr class="top_hr">
      <div class="lower-section">
          <div class="logs_section" [innerHTML]="formatLogs(logs)" style="white-space: pre-line;"></div>
      </div>
    </div>
  </div>
  



  <div
  class="modal"
  id="getSource"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  tabindex="-1"
  aria-labelledby="staticBackdropLabel"
  aria-hidden="true"
>
  <div class="modal-dialog" style="min-width: 45vw;height: 92vh;overflow-y: auto;" >
    <div class="modal-content" >
      <div class="modal-header">
        <h2 class="modal-title" id="staticBackdropLabel" style="font-family: Outfit;"></h2>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <div class="source_selection">
          <h3>Select the Source</h3>
          <label class="radio-label">
            <input type="radio" name="source" value="option1" class="custom-radio" [(ngModel)]="selectedSource"> Structured
          </label>
          <br>
          <label class="radio-label">
            <input type="radio" name="source" value="option2" class="custom-radio" [(ngModel)]="selectedSource"> Unstructured
          </label>
        </div>
        <div *ngIf="loading" class="loading">
          <mat-spinner diameter="50" color="primary"></mat-spinner>
        </div>

        <div *ngIf="selectedSource === 'option2'">
          <div class="file-container">
            <h4>Upload the Files</h4>
            <label for="fileInput" class="file-label">
              <i class="bi bi-upload"></i>
              <svg class="upload-btn" xmlns="http://www.w3.org/2000/svg" width="65" height="65" viewBox="0 0 20 20" fill="none" style="margin-left: 10px;">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M9.33996 7.76667L7.74163 9.3775C7.58667 9.5336 7.49971 9.74463 7.49971 9.96458C7.49971 10.1845 7.58667 10.3956 7.74163 10.5517C7.81774 10.6287 7.90838 10.6898 8.0083 10.7316C8.10822 10.7733 8.21542 10.7948 8.32371 10.7948C8.43199 10.7948 8.5392 10.7733 8.63912 10.7316C8.73904 10.6898 8.82968 10.6287 8.90579 10.5517L9.98079 9.4675L11.0941 10.59C11.1702 10.6671 11.2608 10.7283 11.3607 10.7701C11.4606 10.8119 11.5678 10.8335 11.676 10.8336C11.7843 10.8336 11.8915 10.8122 11.9915 10.7706C12.0914 10.7289 12.1821 10.6678 12.2583 10.5908C12.4127 10.4347 12.4994 10.224 12.4995 10.0043C12.4997 9.78472 12.4133 9.57389 12.2591 9.4175L10.6216 7.7675C10.538 7.68254 10.4382 7.61505 10.3282 7.56896C10.2183 7.52286 10.1002 7.49909 9.98097 7.49901C9.86172 7.49893 9.74364 7.52255 9.6336 7.5685C9.52356 7.61445 9.42375 7.68181 9.33996 7.76667Z" fill="#172B4D"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M9.16663 8.33917L9.16746 16.6608C9.16746 17.125 9.54079 17.5008 10.0008 17.5C10.4616 17.5 10.8341 17.125 10.8341 16.6608L10.8333 8.33833C10.8333 7.87583 10.46 7.5 9.99996 7.5C9.53996 7.5 9.16579 7.87583 9.16663 8.33917Z" fill="#172B4D"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M6.61496 4.5675C6.40091 4.53247 6.18436 4.51492 5.96746 4.515C3.62996 4.51583 1.66663 6.35 1.66663 8.74917C1.66663 11.1733 3.65413 13.3333 5.91663 13.3333H8.31746V11.6725H5.91663C4.53579 11.6725 3.32079 10.2867 3.32079 8.74917C3.32079 7.2675 4.54496 6.17667 5.90746 6.17667H5.91746C6.24163 6.17667 6.48913 6.21917 6.72579 6.30167L6.86746 6.35417C7.37163 6.56083 7.59663 6.14917 7.59663 6.14917L7.72163 5.92667C8.32996 4.80417 9.55579 4.18 10.8183 4.16083C11.6558 4.16917 12.4616 4.48188 13.0856 5.04062C13.7095 5.59937 14.1088 6.36599 14.2091 7.1975L14.2475 7.48083C14.2475 7.48083 14.3066 7.91833 14.8016 7.91833C14.8125 7.91833 14.8116 7.9225 14.8208 7.9225H15.0325C15.9791 7.9225 16.6791 8.72167 16.6791 9.72083C16.6791 10.7267 15.8566 11.6725 14.9541 11.6725H11.6508V13.3333H14.9541C16.7541 13.3333 18.3333 11.6292 18.3333 9.72083C18.3333 8.055 17.24 6.66833 15.7183 6.32583C15.1291 4.07 13.1741 2.5325 10.8133 2.5C9.16746 2.5175 7.56246 3.25083 6.61496 4.5675Z" fill="#172B4D"/>
              </svg>
            </label>
            <input
              type="file"
              id="fileInput"
              (change)="onFileSelected($event)"
              class="file-input"
            multiple
            webkitdirectory/>
          </div>

          <div *ngIf="selectedFile.length!=0">
            File selected ({{selectedFile.length}}): 
            <p *ngFor="let file of selectedFile" style="margin-top: 5px;">* {{file.name}}</p>
          </div>
        </div>

        <div class="connection-input" *ngIf="selectedSource === 'option1'">
          <div class="header1">
            <img src="assets/images/link.svg" alt="" style="height:22px; width:22px;">
            <span>Connections</span>
          </div>
          <div class="inputs">
            
            <div class="inputs-container">
              <label for="input2"><span style="color: red;margin-right: 1px;">*</span>Username</label>
              <input matInput type="text" id="input2" name="input2" [(ngModel)]="userName">
            </div>
            <div class="inputs-container">
              <label for="input3"><span style="color: red;margin-right: 1px;">*</span>Password</label>
              <input type="text" id="input3" name="input3" [(ngModel)]="password">
            </div>
            <div class="inputs-container">
              <label for="input1"><span style="color: red;margin-right: 1px;">*</span>Host </label>
              <input matInput type="text" id="input1" name="input1" [(ngModel)]="hostName">
            </div>
            <div class="inputs-container" >
              <label for="input3"><span style="color: red;margin-right: 1px;">*</span>Port</label>
              <input type="text" id="input3" name="input3" [(ngModel)]="port">
            </div>
            <div class="inputs-container" >
              <label for="input3"><span style="color: red;margin-right: 1px;">*</span>Database</label>
              <input type="text" id="input3" name="input3" [(ngModel)]="database">
            </div>
          </div>
        </div>

        <div *ngIf="successMessage" class="success-message">
          {{ successMessage }}
        </div>

        <div class="button-container">
          <!-- Button placed on the same line at the end -->
          <button id="finishButton" type="button" class="btn btn-primary btn-sm finishButton" (click)="connectDB()"  *ngIf="selectedSource === 'option1' && isStructured==false">
            Connect
          </button>
          <button id="finishButton" type="button" class="btn btn-primary btn-sm finishButton" (click)="structureKg()"  *ngIf="selectedSource === 'option1' && isStructured!=false" [disabled]="isStuctGenerated">
            Generate Structured KG
          </button>
          <button id="finishButton" type="button" class="btn btn-primary btn-sm finishButton"  (click)="next()" *ngIf="selectedSource === 'option1' && isStructured!=false">
            Next
          </button>
          <button id="finishButton" type="button" class="btn btn-primary btn-sm finishButton" (click)="createSource()"  *ngIf="selectedSource === 'option2' && isUnStructured==false">
            Upload
          </button>
          <button id="finishButton" type="button" class="btn btn-primary btn-sm finishButton" (click)="unStructureKg()"  *ngIf="selectedSource === 'option2' && isUnStructured!=false" [disabled]="isUnstructGenerated">
            Generate UnStructured KG
          </button>
          <button id="finishButton" type="button" class="btn btn-primary btn-sm finishButton"  data-bs-dismiss="modal" *ngIf="selectedSource === 'option2' && isUnStructured!=false">
            Close
          </button>
        </div>
        
      </div>
    </div>
  </div>